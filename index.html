<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Chat</title>
<link rel="stylesheet" href="style.css">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>

<body>
<div class="chat-box">
  <div class="header">Chat với admin</div>
  <div class="messages" id="msgs"></div>
  <div class="input">
    <input id="txt" placeholder="Nhập tin...">
    <button onclick="send()">Gửi</button>
  </div>
</div>

<script>
const firebaseConfig={
  apiKey:"API_KEY",
  authDomain:"PROJECT.firebaseapp.com",
  databaseURL:"https://PROJECT.firebaseio.com",
  projectId:"PROJECT"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

const url=new URLSearchParams(location.search);
const uid=url.get("uid")||"guest_"+Date.now();
const name=url.get("name")||"Khách";

const ref=db.ref("chats/"+uid);

ref.on("child_added",s=>{
  const m=s.val();
  const d=document.createElement("div");
  d.className="msg "+m.from;
  d.innerText=m.name+": "+m.text;
  msgs.appendChild(d);
  msgs.scrollTop=msgs.scrollHeight;
});

function send(){
  if(!txt.value)return;
  ref.push({
    text:txt.value,
    from:"me",
    name:name,
    time:Date.now()
  });
  txt.value="";
}
</script>
</body>
</html>
